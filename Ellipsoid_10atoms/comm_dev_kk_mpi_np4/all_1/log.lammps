LAMMPS (7 Feb 2024 - Development - patch_21Nov2023-1039-gc99539c864-modified)
KOKKOS mode with Kokkos version 4.2.0 is enabled (../kokkos.cpp:72)
package kokkos
package kokkos comm device
###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)
###

###
# Box and units  (use LJ units and periodic boundaries)
###

units lj

atom_style ellipsoid

boundary        p p p

###
# Pair interactions require lists of neighbours to be calculated
###
neighbor 3.0 bin
neigh_modify every 1 delay 0 check yes

### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###
#restart 10000 polymer.restart
#############################

#processors 2 1 1

### READ "REstart" data file ###
#read_restart polymer.restart.10000
######################

read_data lmp_data
Reading data file ...
  orthogonal box = (3 -4 -7) to (8 0 3)
  1 by 1 by 2 MPI processor grid
  reading atoms ...
  10 atoms
  reading velocities ...
  10 velocities
  10 ellipsoids
  read_data CPU = 0.002 seconds

### reset timestep ###
reset_timestep 0
######################

###
# Define groups (atom type 1 is group 'all')
###
group all type 1
10 atoms in group all
group polymer type 1
10 atoms in group polymer

###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###
#dump   1   all   custom   100000   polymer.dump.*  id x y z  ix iy iz
#dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"
dump   id all atom 1000 dump.polymer

###################################################################
# Stiffness term
#
# E = K * (theta-thera0)**2, K>0
#
#angle_style   harmonic
#angle_coeff   1 2.0 120.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246152962189 = 2^(1/6) is the minimum of the potential

pair_style      lj/cut 1.12246152962189

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.1

#
#  pair_modify shift yes adds a constant to the potential such
#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

###################################################

#comm_modify cutoff 6
#comm_style tiled
#balance 1.2 rcb

###
# Set up fixes
###

fix 1 all   nve   ###NVE ensemble
#fix 2 all   langevin   1.0 1.0   2.0   424242   ###Langevin integrator Tstart Tstop 1/friction rndseed

compute ekin all ke
compute epot all pe
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_ekin+c_epot

fix 5 all print 1000 "$(step)  ekin = ${ekin} | epot = ${epot} | etot = ${etot}" screen yes

##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
#thermo 10000
#thermo_style   custom   step  temp  epair  emol  press pxx pyy pzz  vol
############################################################################

###
# set timestep of integrator
###
timestep 0.0001 #0.012

###
# run integration for a number of steps
###
run 27000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1224615
  ghost atom cutoff = 4.1224615
  binsize = 2.0612308, bins = 3 2 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/kk, perpetual
      attributes: half, newton on, kokkos_device
      pair build: half/bin/newton/kk/device
      stencil: half/bin/3d
      bin: kk/device
0  ekin = 0 | epot = 24.5770897640616 | etot = 24.5770897640616
Per MPI rank memory allocation (min/avg/max) = 5.25 | 5.25 | 5.25 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              2.457709       0              2.457709       0.8048628    
1000  ekin = 9.25963003325883 | epot = 15.3174576893845 | etot = 24.5770877226433
2000  ekin = 16.7536424303031 | epot = 7.82360595988138 | etot = 24.5772483901845
3000  ekin = 17.4749231741024 | epot = 7.10257695841128 | etot = 24.5775001325137
4000  ekin = 19.0309121012284 | epot = 5.54633723630281 | etot = 24.5772493375312
5000  ekin = 20.6144917609157 | epot = 3.96288787772505 | etot = 24.5773796386408
6000  ekin = 21.3609543816129 | epot = 3.21641017153051 | etot = 24.5773645531435
7000  ekin = 22.5853640638196 | epot = 1.9918223765681 | etot = 24.5771864403877
8000  ekin = 24.1034451933506 | epot = 0.47351912427401 | etot = 24.5769643176246
9000  ekin = 24.0565951804984 | epot = 0.520700300347535 | etot = 24.577295480846
10000  ekin = 22.6191357318236 | epot = 1.95800979062758 | etot = 24.5771455224512
11000  ekin = 20.3514312962637 | epot = 4.22571430112387 | etot = 24.5771455973876
12000  ekin = 18.9802686279943 | epot = 5.59687712512303 | etot = 24.5771457531174
13000  ekin = 20.3295468475212 | epot = 4.24759874972612 | etot = 24.5771455972473
14000  ekin = 22.575519992538 | epot = 2.00162553442167 | etot = 24.5771455269597
15000  ekin = 24.0462738126471 | epot = 0.531056755502191 | etot = 24.5773305681493
16000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
17000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
18000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
19000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
20000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
21000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
22000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
23000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
24000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
25000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
26000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
27000  ekin = 24.5774380689783 | epot = 0 | etot = 24.5774380689783
     27000   1.820551       0              0              2.4577438      0.081924794  
Loop time of 0.36952 on 2 procs for 27000 steps with 10 atoms

Performance: 631306.303 tau/day, 73067.859 timesteps/s, 730.679 katom-step/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.049242   | 0.049362   | 0.049481   |   0.1 | 13.36
Neigh   | 1.1051e-05 | 1.1121e-05 | 1.1191e-05 |   0.0 |  0.00
Comm    | 0.2051     | 0.20522    | 0.20535    |   0.0 | 55.54
Output  | 0.00025048 | 0.00026501 | 0.00027954 |   0.0 |  0.07
Modify  | 0.06875    | 0.068781   | 0.068813   |   0.0 | 18.61
Other   |            | 0.04588    |            |       | 12.42

Nlocal:              5 ave           5 max           5 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:           95.5 ave          97 max          94 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             31 ave          33 max          29 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 62
Ave neighs/atom = 6.2
Neighbor list builds = 1
Dangerous builds = 0

write_data data_out.* nocoeff
System init for write_data ...
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule

Total wall time: 0:00:00
