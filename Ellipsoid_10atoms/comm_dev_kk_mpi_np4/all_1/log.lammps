LAMMPS (7 Feb 2024 - Development - patch_21Nov2023-1045-ge8b69cd74a-modified)
KOKKOS mode with Kokkos version 4.2.0 is enabled (../kokkos.cpp:72)
package kokkos
package kokkos comm device
###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)
###

###
# Box and units  (use LJ units and periodic boundaries)
###

units lj

atom_style ellipsoid

boundary        p p p

###
# Pair interactions require lists of neighbours to be calculated
###
neighbor 3.0 bin
neigh_modify every 1 delay 0 check yes

### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###
#restart 10000 polymer.restart
#############################

processors 2 1 1

### READ "REstart" data file ###
#read_restart polymer.restart.10000
######################

read_data lmp_data
Reading data file ...
  orthogonal box = (3 -4 -7) to (8 0 3)
  2 by 1 by 1 MPI processor grid
  reading atoms ...
  10 atoms
  reading velocities ...
  10 velocities
  10 ellipsoids
  read_data CPU = 0.002 seconds

### reset timestep ###
reset_timestep 0
######################

###
# Define groups (atom type 1 is group 'all')
###
group all type 1
10 atoms in group all
group polymer type 1
10 atoms in group polymer

###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###
compute q all property/atom quatw quati quatj quatk
compute diameter all property/atom shapex shapey shapez
dump 1 all custom 100 dump.polymer id type x y z c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3]
dump_modify 1 colname c_q[1] quatw colname c_q[2] quati colname c_q[3] quatj colname c_q[4] quatk
dump_modify 1 colname c_diameter[1] shapex colname c_diameter[2] shapey colname c_diameter[3] shapez
#dump   1   all   custom   100000   polymer.dump.*  id x y z  ix iy iz
#dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"
#dump   id all atom 1000 dump.polymer

###################################################################
# Stiffness term
#
# E = K * (theta-thera0)**2, K>0
#
#angle_style   harmonic
#angle_coeff   1 2.0 120.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246152962189 = 2^(1/6) is the minimum of the potential

pair_style      lj/cut 1.12246152962189

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.1

#
#  pair_modify shift yes adds a constant to the potential such
#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

###################################################

#comm_modify cutoff 6
#comm_style tiled
#balance 1.2 rcb

###
# Set up fixes
###

fix 1 all   nve   ###NVE ensemble
#fix 2 all   langevin   1.0 1.0   2.0   424242   ###Langevin integrator Tstart Tstop 1/friction rndseed

compute ekin all ke
compute epot all pe
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_ekin+c_epot

fix 5 all print 1000 "$(step)  ekin = ${ekin} | epot = ${epot} | etot = ${etot}" screen yes

##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
#thermo 10000
#thermo_style   custom   step  temp  epair  emol  press pxx pyy pzz  vol
############################################################################

###
# set timestep of integrator
###
timestep 0.001 #0.012

###
# run integration for a number of steps
###
run 25000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1224615
  ghost atom cutoff = 4.1224615
  binsize = 2.0612308, bins = 3 2 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/kk, perpetual
      attributes: half, newton on, kokkos_device
      pair build: half/bin/newton/kk/device
      stencil: half/bin/3d
      bin: kk/device
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (../domain.cpp:965)
0  ekin = 1.56249993015099 | epot = 24.5770897640616 | etot = 26.1395896942125
Per MPI rank memory allocation (min/avg/max) = 5.327 | 5.327 | 5.327 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0.11574074     2.457709       0              2.613959       0.81007114   
1000  ekin = 24.1817258229402 | epot = 1.95888597294207 | etot = 26.1406117958823
2000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
3000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
4000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
5000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
6000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
7000  ekin = 26.1408206460548 | epot = 0 | etot = 26.1408206460548
8000  ekin = 26.1428461359028 | epot = 0 | etot = 26.1428461359028
9000  ekin = 26.0504154291395 | epot = 0.0958317351317459 | etot = 26.1462471642712
10000  ekin = 26.1461003605592 | epot = 0 | etot = 26.1461003605592
11000  ekin = 25.9897377318089 | epot = 0.155629384191367 | etot = 26.1453671160003
12000  ekin = 26.147198627537 | epot = 0 | etot = 26.147198627537
13000  ekin = 26.147198627537 | epot = 0 | etot = 26.147198627537
14000  ekin = 26.147198627537 | epot = 0 | etot = 26.147198627537
15000  ekin = 26.147198627537 | epot = 0 | etot = 26.147198627537
16000  ekin = 25.3437917507546 | epot = 0.804812069167101 | etot = 26.1486038199217
17000  ekin = 25.6982134767805 | epot = 0.41680200834118 | etot = 26.1150154851217
18000  ekin = 25.9789412753301 | epot = 0 | etot = 25.9789412753301
19000  ekin = 25.8645844843629 | epot = 0.114185045966024 | etot = 25.9787695303289
20000  ekin = 25.9779179380786 | epot = 0 | etot = 25.9779179380786
21000  ekin = 25.9809683427659 | epot = 0 | etot = 25.9809683427659
22000  ekin = 25.0088638644455 | epot = 0.971553900589552 | etot = 25.980417765035
23000  ekin = 25.9817053206229 | epot = 0 | etot = 25.9817053206229
24000  ekin = 24.377006375413 | epot = 3.24024964325548 | etot = 27.6172560186685
25000  ekin = 27.6170030785369 | epot = 0 | etot = 27.6170030785369
     25000   2.0457039      0              0              2.7617003      0.092056677  
Loop time of 0.459648 on 2 procs for 25000 steps with 10 atoms

Performance: 4699246.086 tau/day, 54389.422 timesteps/s, 543.894 katom-step/s
99.4% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.046162   | 0.047469   | 0.048777   |   0.6 | 10.33
Neigh   | 0.00010796 | 0.00010979 | 0.00011163 |   0.0 |  0.02
Comm    | 0.29879    | 0.30057    | 0.30235    |   0.3 | 65.39
Output  | 0.0026418  | 0.0031724  | 0.0037031  |   0.9 |  0.69
Modify  | 0.06394    | 0.064249   | 0.064559   |   0.1 | 13.98
Other   |            | 0.04408    |            |       |  9.59

Nlocal:              5 ave           7 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            123 ave         129 max         117 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:           46.5 ave          66 max          27 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 93
Ave neighs/atom = 9.3
Neighbor list builds = 10
Dangerous builds = 0

write_data data_out.* nocoeff
System init for write_data ...
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (../domain.cpp:965)

Total wall time: 0:00:00
