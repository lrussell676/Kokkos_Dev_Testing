LAMMPS (7 Feb 2024 - Development - patch_21Nov2023-1044-gf8ba68cd2d-modified)
KOKKOS mode with Kokkos version 4.2.0 is enabled (../kokkos.cpp:72)
package kokkos
package kokkos comm device
###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)
###

###
# Box and units  (use LJ units and periodic boundaries)
###

units lj

atom_style ellipsoid

boundary        p p p

###
# Pair interactions require lists of neighbours to be calculated
###
neighbor 3.0 bin
neigh_modify every 1 delay 0 check yes

### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###
#restart 10000 polymer.restart
#############################

#processors 2 1 1

### READ "REstart" data file ###
#read_restart polymer.restart.10000
######################

read_data lmp_data
Reading data file ...
  orthogonal box = (-3 -3 -3) to (3 3 3)
  1 by 1 by 2 MPI processor grid
  reading atoms ...
  2 atoms
  reading velocities ...
  2 velocities
  2 ellipsoids
  read_data CPU = 0.002 seconds

### reset timestep ###
reset_timestep 0
######################

###
# Define groups (atom type 1 is group 'all')
###
group all type 1
2 atoms in group all
group polymer type 1
2 atoms in group polymer

###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###
#dump   1   all   custom   100000   polymer.dump.*  id x y z  ix iy iz
#dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"
dump   id all atom 1 dump.polymer

###################################################################
# Stiffness term
#
# E = K * (theta-thera0)**2, K>0
#
#angle_style   harmonic
#angle_coeff   1 2.0 120.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246152962189 = 2^(1/6) is the minimum of the potential

#pair_style      lj/cut 1.12246152962189

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

#pair_coeff      1 1 1.0 1.1

#
#  pair_modify shift yes adds a constant to the potential such
#  that E(r_cut)=0. Forces remains unchanged.
#

#pair_modify     shift yes

###################################################

#comm_modify cutoff 6
#comm_style tiled
#balance 1.2 rcb

###
# Set up fixes
###

fix 1 all   nve   ###NVE ensemble
#fix 2 all   langevin   1.0 1.0   2.0   424242   ###Langevin integrator Tstart Tstop 1/friction rndseed

compute ekin all ke
compute epot all pe
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_ekin+c_epot

fix 5 all print 1000 "$(step)  ekin = ${ekin} | epot = ${epot} | etot = ${etot}" screen yes

##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
#thermo 10000
#thermo_style   custom   step  temp  epair  emol  press pxx pyy pzz  vol
############################################################################

###
# set timestep of integrator
###
timestep 0.001 #0.012

###
# run integration for a number of steps
###
run 30000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (../atom.cpp:2388)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (../comm_brick.cpp:210)
0  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
Per MPI rank memory allocation (min/avg/max) = 4.415 | 4.415 | 4.415 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   1.8749999      0              0              1.4062499      0.0086805552 
1000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
2000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
3000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
4000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
5000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
6000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
7000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
8000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
9000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
10000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
11000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
12000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
13000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
14000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
15000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
16000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
17000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
18000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
19000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
20000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
21000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
22000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
23000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
24000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
25000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
26000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
27000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
28000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
29000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
30000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
     30000   1.8749999      0              0              1.4062499      0.0086805552 
Loop time of 0.414339 on 2 procs for 30000 steps with 2 atoms

Performance: 6255748.087 tau/day, 72404.492 timesteps/s, 144.809 katom-step/s
93.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 4.78e-06   | 5.851e-06  | 6.922e-06  |   0.0 |  0.00
Comm    | 0.1063     | 0.10646    | 0.10662    |   0.0 | 25.69
Output  | 0.073788   | 0.11114    | 0.1485     |  11.2 | 26.82
Modify  | 0.077206   | 0.077941   | 0.078677   |   0.3 | 18.81
Other   |            | 0.1188     |            |       | 28.67

Nlocal:              1 ave           1 max           1 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 5
Dangerous builds = 0

write_data data_out.* nocoeff
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (../comm_brick.cpp:210)

Total wall time: 0:00:00
