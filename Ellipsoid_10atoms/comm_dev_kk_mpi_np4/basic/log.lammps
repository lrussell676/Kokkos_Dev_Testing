LAMMPS (7 Feb 2024 - Development - patch_21Nov2023-1045-ge8b69cd74a)
KOKKOS mode with Kokkos version 4.2.0 is enabled (../kokkos.cpp:72)
package kokkos
package kokkos comm device
###
# Reference paper:
# K. Kremer and G. S. Grest
# Dynamics of entangled linear polymer melts: A molecular-dynamics simulation
# J Chem Phys 92, 5057 (1990)
###

###
# Box and units  (use LJ units and periodic boundaries)
###

units lj

atom_style ellipsoid

boundary        p p p

###
# Pair interactions require lists of neighbours to be calculated
###
neighbor 3.0 bin
neigh_modify every 1 delay 0 check yes

### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###
#restart 10000 polymer.restart
#############################

#processors 2 1 1

### READ "REstart" data file ###
#read_restart polymer.restart.10000
######################

read_data lmp_data
Reading data file ...
  orthogonal box = (-3 -3 -3) to (3 3 3)
  1 by 1 by 2 MPI processor grid
  reading atoms ...
  3 atoms
  reading velocities ...
  3 velocities
  3 ellipsoids
  read_data CPU = 0.002 seconds

### reset timestep ###
reset_timestep 0
######################

###
# Define groups (atom type 1 is group 'all')
###
group all type 1
3 atoms in group all
group polymer type 1
3 atoms in group polymer

###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###
compute q all property/atom quatw quati quatj quatk
compute diameter all property/atom shapex shapey shapez
dump 1 all custom 100 dump.polymer id type x y z c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3]
dump_modify 1 colname c_q[1] quatw colname c_q[2] quati colname c_q[3] quatj colname c_q[4] quatk
dump_modify 1 colname c_diameter[1] shapex colname c_diameter[2] shapey colname c_diameter[3] shapez
#dump   1   all   custom   100000   polymer.dump.*  id x y z  ix iy iz
#dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"
#dump   id all atom 1 dump.polymer

###################################################################
# Stiffness term
#
# E = K * (theta-thera0)**2, K>0
#
#angle_style   harmonic
#angle_coeff   1 2.0 120.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246152962189 = 2^(1/6) is the minimum of the potential

pair_style      lj/cut 1.12246152962189

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.1

#
#  pair_modify shift yes adds a constant to the potential such
#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

###################################################

#comm_modify cutoff 6
#comm_style tiled
#balance 1.2 rcb

###
# Set up fixes
###

fix 1 all   nve   ###NVE ensemble
#fix 2 all   langevin   1.0 1.0   2.0   424242   ###Langevin integrator Tstart Tstop 1/friction rndseed

compute ekin all ke
compute epot all pe
variable ekin equal c_ekin
variable epot equal c_epot
variable etot equal c_ekin+c_epot

fix 5 all print 1000 "$(step)  ekin = ${ekin} | epot = ${epot} | etot = ${etot}" screen yes

##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
#thermo 10000
#thermo_style   custom   step  temp  epair  emol  press pxx pyy pzz  vol
############################################################################

###
# set timestep of integrator
###
timestep 0.001 #0.012

###
# run integration for a number of steps
###
run 100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1224615
  ghost atom cutoff = 4.1224615
  binsize = 2.0612308, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/kk, perpetual
      attributes: half, newton on, kokkos_device
      pair build: half/bin/newton/kk/device
      stencil: half/bin/3d
      bin: kk/device
0  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
Per MPI rank memory allocation (min/avg/max) = 5.125 | 5.188 | 5.25 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0.93749996     0              0              0.93749996     0.0086805552 
1000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
2000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
3000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
4000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
5000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
6000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
7000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
8000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
9000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
10000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
11000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
12000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
13000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
14000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
15000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
16000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
17000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
18000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
19000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
20000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
21000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
22000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
23000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
24000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
25000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
26000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
27000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
28000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
29000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
30000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
31000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
32000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
33000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
34000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
35000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
36000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
37000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
38000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
39000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
40000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
41000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
42000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
43000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
44000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
45000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
46000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
47000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
48000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
49000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
50000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
51000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
52000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
53000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
54000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
55000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
56000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
57000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
58000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
59000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
60000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
61000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
62000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
63000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
64000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
65000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
66000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
67000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
68000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
69000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
70000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
71000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
72000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
73000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
74000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
75000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
76000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
77000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
78000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
79000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
80000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
81000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
82000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
83000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
84000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
85000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
86000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
87000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
88000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
89000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
90000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
91000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
92000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
93000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
94000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
95000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
96000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
97000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
98000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
99000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
100000  ekin = 2.81249987427178 | epot = 0 | etot = 2.81249987427178
    100000   0.93749996     0              0              0.93749996     0.0086805552 
Loop time of 1.69684 on 2 procs for 100000 steps with 3 atoms

Performance: 5091812.662 tau/day, 58933.017 timesteps/s, 176.799 katom-step/s
99.6% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.17956    | 0.1806     | 0.18164    |   0.2 | 10.64
Neigh   | 0.00017532 | 0.000179   | 0.00018268 |   0.0 |  0.01
Comm    | 1.0758     | 1.076      | 1.0761     |   0.0 | 63.41
Output  | 0.0057624  | 0.0080181  | 0.010274   |   2.5 |  0.47
Modify  | 0.25809    | 0.26039    | 0.2627     |   0.5 | 15.35
Other   |            | 0.1717     |            |       | 10.12

Nlocal:            1.5 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:           28.5 ave          29 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:              1 ave           1 max           1 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2
Ave neighs/atom = 0.66666667
Neighbor list builds = 19
Dangerous builds = 0

write_data data_out.* nocoeff
System init for write_data ...
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule

Total wall time: 0:00:01
