###
# Box and units  (use LJ units and periodic boundaries)
###

units           lj
atom_style      ellipsoid
dimension	3
boundary	p p p

lattice		sc 0.75
region		box block 0 10 0 10 0 10
create_box	1 box
create_atoms	1 box

group           all type 1
set             type 1 mass 1.0
set             type 1 shape 1.0 0.4 0.8

# COMMENT IN/OUT RANDOM VALUES OR PRESET ONES
# 
#set             type 1 quat/random 29898
#velocity 	all create 0.1 87287 loop geom

group		subA id 1:200
group		subB id 201:500
group           subC id 501:600
group		subD id 601:1000
set group	subA vx 0.01 vy 0.0 vz 0.0
set group	subB vx -0.03 vy 0.02 vz 0.0
set group	subC vx 0.01 vy 0.01 vz 0.1
set group       subD vx 0.0 vy 0.0 vz 0.0
set group 	subA angmom 0.02 0.0 0.0
set group 	subB angmom 0.01 0.02 0.0
set group 	subC angmom 0.00 0.0 0.03
set group       subD angmom 0.0 0.0 0.0
set group 	subA shape 0.5 0.2 0.2
set group 	subB shape 0.2 0.4 0.3
set group 	subC shape 0.7 0.3 0.3
set group       subD shape 0.4 0.5 0.6
set group 	subA quat 0.9237853184 0.382910976 0.0 0.0
set group 	subB quat 0.5774 0.0 0.5774 0.5774
set group 	subC quat 0.707106816 0.0 0.0 0.707106816
set group       subD quat 0.462 0.191 0.462 0.733

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246152962189 = 2^(1/6) is the minimum of the potential

pair_style      lj/cut 1.12246152962189

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type 
#    * epsilon (energy units) 
#    * sigma (distance units)
#

pair_coeff      1 1 0.1 1.0

#
#  pair_modify shift yes adds a constant to the potential such
#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

###################################################
reset_atoms 	id sort yes

comm_modify cutoff 6

###
# Set up fixes
###

fix 1 all   nve/asphere   ###NVE ensemble
#fix 2 all   langevin   1.0 1.0   2.0   424242   ###Langevin integrator Tstart Tstop 1/friction rndseed

compute ekin all ke
compute epot all pe
compute erot all erotate/asphere
variable ekin equal c_ekin
variable epot equal c_epot
variable erot equal c_erot
variable etot equal c_ekin+c_epot+c_erot

fix 3 all print 1000 "$(step)  ekin = ${ekin} | epot = ${epot} | erot = ${erot} | etot = ${etot}" screen yes

compute q all property/atom quatw quati quatj quatk
compute diameter all property/atom shapex shapey shapez
dump 1 all custom 5000 dump.polymer id type x y z c_q[1] c_q[2] c_q[3] c_q[4] c_diameter[1] c_diameter[2] c_diameter[3]
dump_modify 1 colname c_q[1] quatw colname c_q[2] quati colname c_q[3] quatj colname c_q[4] quatk

###################################################

timestep 0.0001 #0.012

run 100000

write_data data_out.* nocoeff
